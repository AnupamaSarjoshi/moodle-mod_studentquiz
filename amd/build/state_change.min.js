define(["jquery","core/ajax","core/notification","core/loadingicon"],function(a,b,c,d){var e={SELECTOR:{STATE_SELECT:"#menustatetype",CHANGE_STATE_BUTTON:"div.singlebutton button.btn-primary",STATE_VALUE_INPUT:"input[name=state]",SUBMIT_STATE_BUTTON:"#change_state",CHANGE_STATE_NOTIFICATION:"span.change-question-state"},init:function(){var f=a(e.SELECTOR.STATE_SELECT),g=a(e.SELECTOR.CHANGE_STATE_BUTTON),h=a(e.SELECTOR.STATE_VALUE_INPUT),i=a(e.SELECTOR.SUBMIT_STATE_BUTTON);f.on("change",function(){""!==f.val()?(h.val(f.val()),g.removeAttr("disabled"),i.removeAttr("disabled")):(g.attr("disabled","disabled"),i.attr("disabled","disabled"))}),i.on("click",function(){i.attr("disabled","disabled");var g=e.addPendingJSPromise("studentquizStateChange");if("function"==typeof d.addIconToContainerRemoveOnCompletion){var h=a(e.SELECTOR.CHANGE_STATE_NOTIFICATION);d.addIconToContainerRemoveOnCompletion(h,g)}var j,k={courseid:i.attr("data-courseid"),cmid:i.attr("data-cmid"),questionid:i.attr("data-questionid"),state:f.val()},l=b.call([{methodname:"mod_studentquiz_set_state",args:k}],!0,!0);l[0].then(function(a){c.alert(a.status,a.message),g.resolve(),i.removeAttr("disabled")}).fail(j)})},addPendingJSPromise:function(b){M.util.js_pending(b);var d=a.Deferred();return d.then(function(){return M.util.js_complete(b),arguments[0]})["catch"](c.exception),d}};return e});